<!DOCTYPE html>
<html>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="static/css/main.css">
    <link rel="icon" href="/static/image/favicon.png" type="image/gif" sizes="16x16">

    <!---------------------enxi's weather links---------------------------->
    <script src={{ url_for('static',filename='js/jquery-3.3.1.min.js') }} type="text/javascript"></script>

    <!--------------------------------------------------------------------->
</head>
<body>
<!--nav bar-->
<header class="header" id="header">
    <!--nav bar image-->
    <img src="static/image/Banniere.png" alt="Banner" width="100%" height="10%">
    <!--Nav Bar List-->
    <div class="nav" id="nav">
        <ul>
            <li class="index"><a href="index">Home</a></li>
            <li class="stations"><a href="stations">Stations</a>
            <li class="route-planner"><a href="route-planner">Route Planner</a></li>
            <li class="getting-started"><a href="getting-started">Getting Started</a></li>
            <li class="contact"><a href="contact">Contact</a></li>
            <li class="my-account"><a href="my-account">My Account</a></li>
        </ul>
    </div>
</header>
<!--nav bar end-->

<!--main body of content-->

<div class="whitebkgnd" id="whitebkgnd">
    <h1>Station Page</h1>

    <div id="search_date">
        <input type="date" name="date" id="date">
        <select id="time" class="button" name="time">
            <option value='06:00:00'>06:00:00</option>
            <option value='09:00:00'>09:00:00</option>
            <option value='12:00:00'>12:00:00</option>
            <option value='15:00:00'>15:00:00</option>
            <option value='18:00:00'>18:00:00</option>
            <option value='21:00:00'>21:00:00</option>
            <option value='00:00:00'>00:00:00</option>
            <option value='03:00:00'>03:00:00</option>
        </select>
        <button onclick="display()" type="button">Show forecast</button>
        <div id="show_forecast">
        </div>
    </div>
    <div>
        <div id="map" class="map"></div>
        <div id="weather_box" style="border: #5f788a solid;width: 15%;margin: 0 auto;padding: 0;position: relative;
    bottom: -240px; z-index: 99;left: 30%; color: white; text-shadow: black">

        </div>

    </div>
 <!--Enxi bike begin-->
    <div id="bike_prediction">
        <select id="forecast_time" class="button" name="time">
            <option value='06:00:00'>06:00:00</option>
            <option value='09:00:00'>09:00:00</option>
            <option value='12:00:00'>12:00:00</option>
            <option value='15:00:00'>15:00:00</option>
            <option value='18:00:00'>18:00:00</option>
            <option value='21:00:00'>21:00:00</option>
            <option value='00:00:00'>00:00:00</option>
            <option value='03:00:00'>03:00:00</option>
        </select>
        <select id="station_list">
        </select>
        <button onclick="get_prediction()" type="button">Show Bikes Prediction</button>
        <p id="available_bikes"></p>
    </div>
    <!--Enxi bike end-->

    <div id="root"></div>


    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>
    <script type="text/javascript">
        var map;

        function initMap() {
            map = new
            google.maps.Map(document.getElementById('map'), {
                center: {lat: 53.350140, lng: -6.266155},
                zoom: 11
            });
        }

        const app = document.getElementById('root');

        $.ajax({
            url: 'http://api.openweathermap.org/data/2.5/weather?appid=ae679d7b6212a1a3daf681d0d843aa83&q=Dublin&units=metric',
            type: "GET",
            dataType: "jsonp",
            jsonpCallback: "jsonp",
            success: function (data) {

                let widget = "<h3 style='padding-top:5px;'><strong>Current weather</strong>  </h3>" +
                    "<img src = 'http://openweathermap.org/img/w/" + data.weather[0].icon + ".png' > " + data.weather[0].description +


                    "<h3 style='text-align: center;border-bottom:thick double black; padding-bottom: 10%'>" + data.main.temp + "&deg;C</h3>" + "</hr>" +

                    "<h3 style='padding-top:5px; font-size: 110%'>Humidity levels at: " + data.main.humidity + " %</h3>" +

                    "<h3 style='padding-top:5px; font-size: 110%'>Winds at: " + data.wind.speed + " m/s</h3>"
                document.getElementById("weather_box").innerHTML = widget;

            }
        })


    </script>

    <script type="text/javascript">

        function display() {
            var date = $("#date").val();
            var time = $("#time").val();

            if (date != '' && time != '') {
                $.ajax({
                    url: 'http://api.openweathermap.org/data/2.5/forecast?appid=ae679d7b6212a1a3daf681d0d843aa83&q=Dublin&units=metric',
                    type: "GET",
                    dataType: "jsonp",
                    jsonpCallback: "jsonp",
                    success: function (data) {
                        var a = 0;
                        for (var i = 0; i < data.list.length; i++) {
                            if (data.list[i].dt_txt == date + ' ' + time) {

                                let fore = "<img src = 'http://openweathermap.org/img/w/" + data.list[i].weather[0].icon + ".png' > " + data.list[i].weather[0].description +

                                    "<h3 style='text-align: center;border-bottom:thick double black; padding-bottom: 10%'>" + data.list[i].main.temp + "&deg;C</h3>" + "</hr>" +
                                    "<h3 style='padding-top:5px; font-size: 110%'>Humidity levels at: " + data.list[i].main.humidity + " %</h3>" +
                                    "<h3 style='padding-top:5px; font-size: 110%'>Winds at: " + data.list[i].wind.speed + " m/s</h3>"
                                document.getElementById("show_forecast").innerHTML = fore;
                                var a = 1;
                            }

                        }
                        if (a == 0) {
                            alert("Error");
                        }

                    }
                });
            }
        }
        <!--Enxi bike begin-->

        var station_json ={{ stations_json | tojson }};
        let content = "";
        for (let i = 0; i < station_json.length; i++) {
            content += "<option value=" + station_json[i].number + ">" + station_json[i].name + "</option>"
        }
        document.getElementById('station_list').innerHTML = content;

        function get_prediction() {
            var time_hour = parseInt(document.getElementById('forecast_time').value.slice(0, 2));
            var station_id = parseInt(document.getElementById('station_list').value);
            $.get("/bikes_prediction?time_hour=" + time_hour + "&station_id=" + station_id, function (data, status) {
                document.getElementById("available_bikes").innerHTML = "Number of available bikes: " + data;
            }
        )};
<!--Enxi bike end-->

    </script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key={{ MAPS_APIKEY }}
&amp;callback=initMap"
            type="text/javascript">


    </script>


</div>


<script src="static/js/main.js"></script>
</body>
</html>